helper-repack-iso-mount-smb() { local entry="$1"; local IFS=','; read -r src field2 <<< "$entry"; src="${src%\"}"; src="${src#\"}"; field2="${field2%\"}"; field2="${field2#\"}"; local mount_opts=""; [[ "$field2" == *"username="* ]] && mount_opts="$field2"; local share=$(cut -d'/' -f3,4 <<< "$src"); local mount_point="$workdir/tmp/${share//[\/:]/_}"; if ! mountpoint -q "$mount_point"; then mkdir -p "$mount_point"; mount.cifs "//$share" "$mount_point" -o "${mount_opts:-username=guest,password=}" || return 1; fi; local remainder=$(cut -d'/' -f5- <<< "$src"); echo "${mount_point}${remainder:+/$remainder}"; }