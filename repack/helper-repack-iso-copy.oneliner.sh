helper-repack-iso-copy() { local arr_name="$1" dest_base="$2"; eval "local arr=(\"\${${arr_name}[@]}\")"; for entry in "${arr[@]}"; do [[ "$entry" != *","* ]] && entry="$entry,"; local src="${entry%%,*}"; local rest="${entry#*,}"; local dest=""; if [[ "$src" == //* ]]; then src=$(helper-repack-iso-mount-smb "$entry") || continue; (( $(awk -F',' '{print NF-1}' <<< "$entry") > 1 )) && dest=$(awk -F',' '{print $NF}' <<< "$entry") || dest=""; else dest="$rest"; fi; [[ "$src" == "$dest" ]] && dest=""; local dest_path="$dest_base/${dest:-}"; [[ ! -e "$src" ]] && { echo "Warning: Source '$src' not found, skipping."; continue; }; mkdir -p "$dest_path"; [[ -d "$src" ]] && src="${src%/}/."; cp -a "$src" "$dest_path/" || continue; done; }