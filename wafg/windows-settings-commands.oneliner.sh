BAD
windows-settings-commands() { for setting in "$@"; do case "$setting" in ControlPanelCategoryView) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v StartupPage /t REG_DWORD /d 0 /f' desc="Control Panel Category View" flag=true ;; ControlPanelClassicView) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v StartupPage /t REG_DWORD /d 1 /f' desc="Control Panel Classic View" flag=true ;; ControlPanelLargeIconSize) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v AllItemsIconView /t REG_DWORD /d 0 /f' desc="Control Panel Large Icon Size" flag=false ;; ControlPanelSmallIconSize) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel" /v AllItemsIconView /t REG_DWORD /d 1 /f' desc="Control Panel Small Icon Size" flag=false ;; PasswordDontExpires) cmd="cmd /C wmic useraccount where name=\"$username\" set PasswordExpires=false" desc="Password Never Expires" flag=false ;; PasswordExpires) cmd="cmd /C wmic useraccount where name=\"$username\" set PasswordExpires=true" desc="Password Expires" flag=false ;; AddThisPCDesktop) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel" /v "{20D04FE0-3AEA-1069-A2D8-08002B30309D}" /t REG_DWORD /d 0 /f' desc='Add This PC icon to desktop' ;; AddThisPCDesktopAllUsers) cmd='reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel" /v "{20D04FE0-3AEA-1069-A2D8-08002B30309D}" /t REG_DWORD /d 0 /f && reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu" /v "{20D04FE0-3AEA-1069-A2D8-08002B30309D}" /t REG_DWORD /d 0 /f' desc='Add This PC icon to desktop for all users' ;; AddUsersFilesIconAllUsers) cmd='reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel" /v "{59031a47-3f72-44a7-89c5-5595fe6b30ee}" /t REG_DWORD /d 0 /f && reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu" /v "{59031a47-3f72-44a7-89c5-5595fe6b30ee}" /t REG_DWORD /d 0 /f' desc='Add Users files icon to desktop for all users' ;; AllowConnectingSharesWithoutPassword) cmd='reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters" /v AllowInsecureGuestAuth /t REG_DWORD /d 1 /f' desc='Allow connecting to shares without passwords' ;; DeleteTaskbarPinnedApps) cmd='reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /f' desc='Delete pinned apps in taskbar' ;; DisableHibernation) cmd='powercfg.exe /hibernate off' desc='Disable hibernation' ;; DisableLockScreen) cmd='reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows" /v NoLockScreen /t REG_DWORD /d 1 /f' desc='Disable lock screen' ;; DisableLoginAfterSleep) cmd='powercfg /setdcvalueindex SCHEME_CURRENT SUB_NONE CONSOLELOCK 0 && powercfg /setacvalueindex SCHEME_CURRENT SUB_NONE CONSOLELOCK 0' desc='Disable login after sleep' ;; DisableMeetNow) cmd='reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f' desc='Disable Meet Now for current user' ;; DisableMeetNowAllUsers) cmd='reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f' desc='Disable Meet Now for all users' ;; EnableFilePrinterSharing) cmd='netsh advfirewall firewall set rule group="File and Printer Sharing" new enable=Yes' desc='Enable File and Printer Sharing' ;; EnableGuestAccount) cmd='net user Guest /active:yes' desc='Enable guest account' ;; EnablePowershellScripts) cmd='powershell -command Set-ExecutionPolicy Unrestricted' desc='Allow PowerShell scripts' ;; KillEdge) cmd='taskkill /IM msedge.exe /F' desc='Kill Edge' ;; KillOnedrive) cmd='taskkill /f /im OneDrive.exe' desc='Kill OneDrive' ;; RemoveWallpaper) cmd='reg add "HKEY_CURRENT_USER\Control Panel\Desktop" /v WallPaper /t REG_SZ /d "" /f' desc='Remove wallpaper' ;; SetAppDarkMode) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f' desc='Enable App Dark Mode' ;; SetBackgroundDarkGrey) cmd='reg add "HKEY_CURRENT_USER\Control Panel\Colors" /v Background /t REG_SZ /d "20 20 20" /f' desc='Set background color to dark grey' ;; SetSystemDarkMode) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f' desc='Enable System Dark Mode' ;; Show24HourTime) cmd='reg add "HKCU\Control Panel\International" /v sShortTime /t REG_SZ /d "HH:mm:ss" /f' desc='Show 24-hour time format' ;; ShowFileExtensions) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f' desc='Show file extensions for known file types' ;; ShowHiddenFiles) cmd='reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Hidden /t REG_DWORD /d 1 /f' desc='Show hidden files' ;; ShowSecondsOnTaskbar) cmd='reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowSecondsInSystemClock /t REG_DWORD /d 1 /f' desc='Show seconds on taskbar' ;; SwitchToHighPerformancePlan) cmd='powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c' desc='Switch to high performance plan' ;; TurnOffCortanaButton) cmd='reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowCortanaButton /t REG_DWORD /d 0 /f' desc='Turn off Cortana button on taskbar' ;; TurnOffSearchBox) cmd='reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 0 /f' desc='Turn off search box on taskbar' ;; TurnOffTaskViewButton) cmd='reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 1 /f' desc='Turn off Task View button on taskbar' ;; Clear) windows-shell-setup-clear-firstlogoncommands ;; *) echo "Warning: Unknown setting '$setting' will be ignored in (windows-settings-commands)." ;; esac; [[ -n "$cmd" ]] && windows-shell-setup-add-firstlogoncommands "$cmd" "$desc" "$flag"; done; }