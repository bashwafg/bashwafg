windows-shell-setup-specialcommand() { [[ "$1" =~ ^[0-9]+$ ]] && { local index="$1" command desc req order; eval "command=\${specialcommandarr_${index}_commandline} desc=\${specialcommandarr_${index}_description} req=\${specialcommandarr_${index}_requiresinput} order=\${specialcommandarr_${index}_order}"; [[ -z "$command" ]] && return; [[ -z "$order" ]] && order="$WINDOWS_SHELL_SETUP_ORDER" && ((WINDOWS_SHELL_SETUP_ORDER++)) || (( order > WINDOWS_SHELL_SETUP_ORDER )) && WINDOWS_SHELL_SETUP_ORDER=$((order + 1)); echo -e "\t\t\t<SynchronousCommand wcm:action=\"add\">\n\t\t\t\t<Order>$order</Order>\n\t\t\t\t${desc:+<Description>$desc</Description>\n}\t\t\t\t<RequiresUserInput>$req</RequiresUserInput>\n\t\t\t\t<CommandLine>$command</CommandLine>\n\t\t\t</SynchronousCommand>"; return; }; [[ -z "${WINDOWS_SHELL_SETUP_ORDER}" ]] && WINDOWS_SHELL_SETUP_ORDER=1; local order="" command="" desc="" req="false"; while [[ $# -gt 0 ]]; do case "$1" in Order) shift; order="$1";; CommandLine) shift; command="$1";; Description) shift; desc="$1";; RequiresUserInput) shift; req="$1";; esac; shift; done; [[ -z "$command" ]] && return; [[ -z "$order" ]] && order="$WINDOWS_SHELL_SETUP_ORDER" && ((WINDOWS_SHELL_SETUP_ORDER++)) || (( order > WINDOWS_SHELL_SETUP_ORDER )) && WINDOWS_SHELL_SETUP_ORDER=$((order + 1)); echo -e "\t\t\t<SynchronousCommand wcm:action=\"add\">\n\t\t\t\t<Order>$order</Order>\n\t\t\t\t${desc:+<Description>$desc</Description>\n}\t\t\t\t<RequiresUserInput>$req</RequiresUserInput>\n\t\t\t\t<CommandLine>$command</CommandLine>\n\t\t\t</SynchronousCommand>"; }